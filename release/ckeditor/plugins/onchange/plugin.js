CKEDITOR.plugins.add("onchange",{init:function(a){function b(){a.readOnly||d||(d=setTimeout(function(){d=0;a.fire("change")},a.config.minimumChangeMilliseconds||100))}var d,g=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,f;a.on("destroy",function(){d&&clearTimeout(d);d=null});a.on("saveSnapshot",function(a){a.data&&a.data.contentOnly||b()});var e=a.getCommand("undo");e&&e.on("afterUndo",b);(e=a.getCommand("redo"))&&e.on("afterRedo",b);a.on("afterCommandExec",function(a){"source"!=
a.data.name&&!1!==a.data.command.canUndo&&b()});g&&(f=new g(function(a){b()}),window.console&&window.console.log&&console.log("Detecting changes using MutationObservers"));a.on("contentDom",function(){if(f)var c=setInterval(function(){"object"===typeof a.document&&(f.observe(a.document.getBody().$,{attributes:!0,childList:!0,characterData:!0}),clearInterval(c))},100);a.document.on("keydown",function(a){a.data.$.ctrlKey||a.data.$.metaKey||(a=a.data.$.keyCode,(8==a||13==a||32==a||46<=a&&90>=a||96<=
a&&111>=a||186<=a&&222>=a||229==a)&&b())});a.document.on("drop",b);a.document.getBody().on("drop",b)});a.on("mode",function(c){"source"==a.mode&&(c=a.textarea||a._.editable,c.on("keydown",function(a){a.data.$.ctrlKey||a.data.$.metaKey||b()}),c.on("drop",b),c.on("input",b),CKEDITOR.env.ie&&(c.on("cut",b),c.on("paste",b)))})}});